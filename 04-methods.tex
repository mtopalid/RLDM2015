\section{Methods}

The architectural basis of the model has been originally described in
\citet{Guthrie:2013} where authors introduced a biophysical model of action
selection that can solve a two-armed bandit task. Two parallel action selection
pathways compose the model with inputs from distinct areas of the cortex: one
for dealing with the cognitive action selection, and the other for the motor
one. The model includes the cortex (Cx), Thalamus (Th) and several nuclei of
the BG: Striatum (Str), Subthalamus (STN), Globus pallidus (GPi). Each module
is made of a closed-loop positive feedback direct pathway (Cx-Str-GPi-Th-Cx)
and a closed-loop negative feedback hyperdirect pathway (Cx-STN-GPi-Th-Cx) and
is based on the center-surround architecture of \cite{Mink:1996}. The
interaction between these two pathways is able to induce an action selection at
the motor level. However, the task requires first the actual selection of the
best cue before performing the corresponding motor action. In the
\citet{Guthrie:2013} model, this is implemented at the striatal level where a
dopamine reward signal is used to implement a simple value-based learning. The
general architectural of the model is illustrated on Figure \ref{fig:architecture}.

However, in the original model, the inactivation of basal ganglia output (GPi)
results in the inability of the model to make a decision because there is no
competitive mechanism at the cortical level. We thus added lateral connections
in each cortical modules (self-excitation and surround inhibition) such that a
unique cognitive and motor decision can be made. However, at this stage, there
is no guarantee that the motor decision corresponds to the cognitive ones. The
model can choose cue A but moves toward location of cue B. To overcome this
problem, we also need to establish a cross-talking between the different
cortical modules, independently of BG pathways. This has been made using
excitatory connections from and to the associative cortical module. With proper
learning, this allow the cortex to make a consistent decision in the absence of
GPi, even if it does not guarantee to make the optimal decision.

One important property of the cortical decision is that it is significantly
slower than the BG decision. This can be shown by measuring the time of motor
decision, which has been defined at the time where the difference between the
two most activated units in the motor cortex is greater than a given threshold
(40Hz). Before learning, the BG decision time (GPi is intact) is around 250ms
while the cortical decision time (GPi is disabled) is around 800 ms. This
difference in timing is actually critical for the BG to teach the cortex as
explained in the results section.
